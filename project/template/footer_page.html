<!DOCTYPE html>
<html class="no-js">
	<head >

    <style> 
      .dropdiv{ cursor:pointer;}
 </style>
    	
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Service Renewal Management</title>

    <!-- Bootstrap -->
        
    <!--begin::Web font -->
	<!-- <script>
     WebFont.load({
       google: {"families":["Poppins:300,400,500,600,700","Roboto:300,400,500,600,700"]},
       active: function() {
         sessionStorage.fonts = true;
       }
       });
	</script> -->
	<!--end::Web font -->
        
    <!--js_part-->
    <!-- <script src="/static/js/jquery.min.js" type="text/javascript"></script> -->
    <script src="/static/js/jquery-1.10.2.min.js" type="text/javascript"></script>

    <script src="/static/js/bootstrap.js" type="text/javascript"></script>
    <script src="/static/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="/static/js/npm.js" type="text/javascript"></script>
    <script src="/static/js/jquery.form.js"></script>

    
    <script src="/static/js/jquery-ui.min.js" type="text/javascript"></script>

    <!--js_part_end-->
    
    <!--css_part-->
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Merienda One">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Lato">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Poppins">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" media="all">
    <link href="/static/css/bootstrap-theme.css" rel="stylesheet" type="text/css">
    <link href="/static/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">
    <link href="/static/css/bootstrap.css" rel="stylesheet" type="text/css">
    <link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <!--for_menu-->
    <link href="/static/css/menu/style.css" rel="stylesheet" type="text/css"> 
    <link href="/static/css/menu/index.js" rel="stylesheet" type="text/css"> 
    <!--for_menu_end-->
    <link href="/static/css/customstyle.css" rel="stylesheet" type="text/css">
    <!-- <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script> -->
        
     <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
    <script src="http://code.jquery.com/ui/1.8.20/jquery-ui.min.js" type="text/javascript"></script>
    <script src="http://jquery-ui.googlecode.com/svn/tags/latest/external/jquery.bgiframe-2.1.2.js" type="text/javascript"></script>
    <script src="http://jquery-ui.googlecode.com/svn/tags/latest/ui/minified/i18n/jquery-ui-i18n.min.js" type="text/javascript"></script>

   <!--  <script src="http://jquery-ui.googlecode.com/svn/tags/latest/external/jquery.bgiframe-2.1.2.js" type="text/javascript"></script>
    <script src="http://jquery-ui.googlecode.com/svn/tags/latest/ui/minified/i18n/jquery-ui-i18n.min.js" type="text/javascript"></script> -->
        
    <!--css_part_end-->

	</head>

	<body class="inner_page_body">
    	
       <!--logo_part-->
       <div class="container-fluid top_part">
           <div class="container1">
               <div class="col-md-12">
                  <div class="row">

                      <!--logo_and_navigation_part-->
                                <!--middle_part-->
                                  <nav id='cssmenu'>
                                    <div class="logo" id="small_logo"><a href="index.php"><img src="/static/image/footerlogo.png" class="img-responsive"></a></div>
                                    <!-- <div class="logo"><a href="index.php"><img src="image/logo.png" class="img-responsive"></a></div> -->
                                    <div id="head-mobile"></div>
                                    <div class="button"></div>
                                    
                                    <ul class="pull-right nav_top">
                                         
                                     <li class='active'><a href='/dashboard/'>Dashboard</a></li>
                                    
                                    <!--  <li><a href='stake_add_service.html'>Add Service</a></li>     
                                        
                                     <li><a href='admin_history.html'>History</a></li>
                                        
                                     <li><a href='admin_view.html'>View</a></li> -->
                                        
                                     <li><a href='/user_logout/'>Logout</a></li>
                                        
                                     <!-- <li><a href='javascript:;'>ANNUAL REPORT</a>
                                      <ul>
                                         <li><a href='annualreport201516&201617.php'>2015-16 & 2016-17</a></li>
                                         <li><a href='upload/annualreport201011to201415.doc' download>2010-11 to 2014-15</a></li>
                                      </ul>
                                     </li> -->
                                     
                                     </ul>
                                      
                                 </nav>
                                <!--middle_part_end-->
                        <!--logo_and_navigation_part_end-->

                  </div>
               </div>
           </div>
       </div>
       <!--logo_part_end-->
        
       <div class="container1">
           

<form method="post" id="left_form" name="left_form">   {% csrf_token %}
        <!-- left_part -->
         <div class="col-md-4">
          <div class="dragitems table-responsive">
           <div style=" height:400px; overflow:scroll;"> 

            <input type="hidden" id="section"  name="section" value="footer">


           <table class="table table-bordered">

{% if found_prompt|length == 0 %}
            <tr class="table_header">
             <td>Columns</td>      
             <td>Original</td>
             <td>Innova</td>
             <!-- <td>Search</td> -->

             {% if code_present %}

              <td>Code</td>

            {% endif %}

            <td>Auto Prompt</td>


            </tr>

      {% for f in fields %}

            <tr id="allItems" style=" background:#fff;">
             <td>c{{count|add:forloop.counter}} </td>

             <td>{{f}}</td>

             <!-- <td><input type="text" name="get_prompt{{forloop.counter}}" value='{{f|slice:":20"}}'></td> -->
             <td><input type="text" name="get_prompt{{forloop.counter}}" value='{{f}}'></td>

             <!-- <td><input type="checkbox" name="search" value="{{forloop.counter}}"></td> -->


             {% if code_present %}
             <td><input type="checkbox" name="code{{forloop.counter}}"></td>
             {% endif %}

             <td>
                <select name="auto_prompt{{forloop.counter}}" id="auto_prompt{{forloop.counter}}">
                      
                      <option>No</option>
                      <option>Yes</option>
                </select>
             </td>

            </tr>

      {% endfor %}

{% else %}
          <tr class="table_header">
             <td>Columns</td>      
             <td>Innova</td>
            <!--  <td>Search</td>
             <td>Code</td> -->
            </tr>

      {% for f in found_prompt %}

            <tr id="allItems" style=" background:#fff;">
             <td>c{{count|add:forloop.counter}}</td>

             {% if f|length > 10 %}
              
              <td id="c{{count|add:forloop.counter}}">{{f|slice:":10"}}...</td>          
              
            {% else %}

              <td id="c{{count|add:forloop.counter}}">{{f}}</td>             

            {% endif %}         

            <!--  <td><input type="checkbox" name="search{{forloop.counter}}"></td>
             <td><input type="checkbox" name="code{{forloop.counter}}"></td> -->

            </tr>

      {% endfor %}

{% endif %}


           </table>

           <div> 
          </div>
         </div>
         </div>

         <div class="text-right">          
            <input type="button" name="left_submit" id="left_submit" class="btn btn-success" value="SAVE">
            <input type="button" name="left_reset" id="left_reset"  class="btn btn-info" value="RESET">
         </div>


         </div>

</form>
        <!-- left_part -->
           
        <!-- right_part -->
         <div class="col-md-8" id="right_table">

<form id="right_form" name="right_form" method="post">   {% csrf_token %}


           <div style=" height:400px; overflow:scroll;"> 
    {% if found_prompt|length < 1 %}
           <div class="dropitems1 table-responsive" style="pointer-events:none;">
    {% else %}
           <div class="dropitems1 table-responsive">
    {% endif %}

     <input type="hidden" id="section" name="section" value="footer">


<!-- Footer Section -->
    <label>Footer Section</label>
            <table class="table table-bordered">
             <tr class="table_header">
              <td>Column 1</td>
              <td>Column 2</td>
              <td>Column 3</td>
              <td>Column 4</td>
              <td>Column 5</td>
              <td>Column 6</td>
              <td>Column 7</td>
              <td>Column 8</td>
              <td>Column 9</td>
              <td>Column 10</td>
             </tr>

  {% if footer_table != '' %}

            {{footer_table|safe}}


  {% else %}

        {% for i in head_row %}
             <tr style=" background:#fff;">
              <td><input type="text" name="FRA{{forloop.counter}}" class="form-control inputtype1 dropdiv" ></td>
              <td><input type="text" name="FRB{{forloop.counter}}" class="form-control inputtype1 dropdiv"></td>
              <td><input type="text" name="FRC{{forloop.counter}}" class="form-control inputtype1 dropdiv"></td>
              <td><input type="text" name="FRD{{forloop.counter}}" class="form-control inputtype1 dropdiv"></td>
              <td><input type="text" name="FRE{{forloop.counter}}" class="form-control inputtype1 dropdiv"></td>
              <td><input type="text" name="FRF{{forloop.counter}}" class="form-control inputtype1 dropdiv"></td>
              <td><input type="text" name="FRG{{forloop.counter}}" class="form-control inputtype1 dropdiv"></td>
              <td><input type="text" name="FRH{{forloop.counter}}" class="form-control inputtype1 dropdiv"></td>
              <td><input type="text" name="FRI{{forloop.counter}}" class="form-control inputtype1 dropdiv"></td>
              <td><input type="text" name="FRJ{{forloop.counter}}" class="form-control inputtype1 dropdiv"></td>
             </tr>
        {% endfor %}


  {% endif %}
            </table>
            

<!-- Footer Section Ends Here -->


            </div>

</form>

           </div>
           

           <div class="text-right">          
            <input type="button" name="back_button" id="back_button"  class="btn btn-info" value="BACK">
            <input type="button" name="right_submit" id="right_submit" class="btn btn-success" value="SAVE">
            <input type="button" name="next_button" id="next_button"  class="btn btn-info" value="NEXT">
            <!-- <input type="button" name="right_reset" id="right_reset" class="btn btn-info" value="RESET"> -->
           </div>
         
        <!-- right_part -->      

      </div>
        
      <!-- footer -->
        <!-- <div class="container-fluid footer_background">
         <div class="container1">
          <div class="col-md-12">
           <div class="row"> -->
            <!--middle_part-->
             <!-- <p>2018 &copy; Service Renewal Management theme by <a href="javascript:;">Iums Pvt. Ltd.</a></p> -->
            <!--middle_part-->
          <!--  </div>
          </div>
         </div>
        </div> -->
      <!-- footer_end -->
        
      <script language="javascript" type="text/javascript">
        $(function() {
        $("#allItems > td").draggable({
               helper: "clone",
               cursor: "move",
               revert: "invalid"
           });

           initDroppable($(".dropdiv"));

           function initDroppable($elements) {
               $elements.droppable({
                   activeClass: "ui-state-default",
                   hoverClass: "ui-drop-hover",
                   accept: ":not(.ui-sortable-helper)",

                   over: function (event, ui) {
                       var $this = $(this);
                   },
                   drop: function (event, ui) {
                       var $this = $(this);
                       if ($this.val() == '') {
                           // $this.val(ui.draggable.text().trim());
                           $this.val(ui.draggable.text().trim()+'|'+ui.draggable.attr('id'));

                       } 
                       // else {
                       //     $this.val($this.val() + "," + ui.draggable.text().trim());
                       // }
                   }
               });
           }
            
        });

      </script>


<!-- ========================================================================================= -->
  <script type="text/javascript">

$( document ).ready(function() {
    var val = "{{found_prompt|length}}";

      var final = "{{finalized}}";

   if(final != 'True'){

            if(val > 0){
                $('#left_reset').prop('disabled', false);
                $('#left_submit').prop('disabled', true);
                $('#right_submit').prop('disabled', false);

            }
            else{
                $('#left_reset').prop('disabled', true);
                $('#left_submit').prop('disabled', false);
                $('#right_submit').prop('disabled', true);
            }
     }
    else{
        $('#left_reset').prop('disabled', true);
         $('#left_submit').prop('disabled', true);
         $('#right_submit').prop('disabled', true);

    }


});


    // found_prompt|length
    
    $('#right_reset').click(function(){

        document.getElementById("right_form").reset();
    });

$('#left_reset').click(function(){
      
        var e = confirm("Are You Sure ?");

        if(e){            
              console.log('workiajsh');

               $.post( '/reset_table/{{record_id}}/', { reset: "reset", csrfmiddlewaretoken: document.getElementsByName('csrfmiddlewaretoken')[0].value, 'section':'footer' })
                     .done(function(data) {

                          if(data.status == 1){

                           window.location.href = '/design_footer/{{record_id}}/';            
                          }
                     });
        }
    

});


$('#left_submit').click(function(){
       var count = 0;

     $.each($("input[name='search']:checked"), function(){          
          count = count +1;
      });

     if(count == 0){
        var e = confirm("You did not selected any search fields. Are you sure, you want to proceed ?");

        if(e){
              post_record();
        }
     }

     else if(count > 3){
       alert("Sorry, You can not select more than 3 search fields");
     }

     else{
          post_record();
     }

       
});

function post_record(){

        // console.log($( "#left_form" ).serialize());

        $.post( '/add_records/{{record_id}}/', $( "#left_form" ).serialize() ).done(function(data){

              if(data.status == 1){
                  alert('Changes Saved Successfully');
                  window.location.href = '/design_footer/{{record_id}}/';
              }
              else{
                  alert(data.message);
              }

          });
}


$('#right_submit').click(function(){

     

      

       // $('#_form').ajaxSubmit({ url: '/add_records/'+id.toString()+'/', type: 'post', 
       //    success: function(data){ }});

        $.post( '/add_design/{{record_id}}/', $( "#right_form" ).serialize() ).done(function(data){
            if(data.status == 1){
             

              window.location.href = '/preview/{{record_id}}/';

            }
            else{
                alert(data.message);
            }

        });

});

$('#next_button').click(function(){

  window.location.href = "/preview/{{record_id}}/";
})

$('#back_button').click(function(){

  window.location.href = "/design_body/{{record_id}}/";
})




  </script>
        
	</body>
</html>
